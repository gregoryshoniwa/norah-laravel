import{_ as y,c as d,o as c,a as t,d as w,w as g,v as f,b as T,f as u,t as l,F as v,r as b,n as h,e as m}from"./app-B5fSuZ6Z.js";/* empty css            */const _={name:"Transactions",data(){return{loading:!1,search:"",filters:{startDate:"",endDate:"",status:""},stats:{totalVolume:0,completed:0,pending:0,failed:0},transactions:[],selectedTransaction:null,currentPage:1,itemsPerPage:10,totalItems:0,currency:"USD"}},computed:{totalPages(){return Math.ceil(this.totalItems/this.itemsPerPage)},startIndex(){return(this.currentPage-1)*this.itemsPerPage+1},endIndex(){return Math.min(this.startIndex+this.itemsPerPage-1,this.totalItems)},visiblePages(){let e=[],s=Math.max(1,this.currentPage-2),r=Math.min(this.totalPages,s+4);for(let o=s;o<=r;o++)e.push(o);return e}},methods:{formatAmount(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:this.currency}).format(e)},formatDate(e){return new Date(e).toLocaleString()},applyFilters(){this.loadTransactions()},async loadTransactions(){this.loading=!0;try{const e=await m.get("/api/v1/transactions/all",{params:{search:this.search,page:this.currentPage,per_page:this.itemsPerPage,status:this.filters.status,start_date:this.filters.startDate,end_date:this.filters.endDate,currency:this.currency}});e.data.success&&(this.transactions=e.data.data.data,this.currentPage=e.data.data.current_page,this.totalItems=e.data.data.total,await this.loadTransactionStats())}catch(e){console.error("Error loading transactions:",e),this.$swal.fire("Error!","Failed to load transactions","error")}finally{this.loading=!1}},async loadTransactionStats(){try{const e=await m.get("/api/v1/dashboard/stats",{params:{currency:this.currency}});if(e.data.success){this.stats.totalVolume=e.data.data.totalVolume;const s=await m.get("/api/v1/transactions/all",{params:{count_by_status:!0,currency:this.currency}});if(s.data.success){const r=s.data.data;this.stats.completed=r.COMPLETED||0,this.stats.pending=r.PENDING||0,this.stats.failed=r.FAILED||0}}}catch(e){console.error("Error loading transaction stats:",e)}},changePage(e){this.currentPage=e,this.loadTransactions()},async viewDetails(e){try{const s=await m.get(`/api/v1/transactions/details/${e.id}`);if(s.data.success){const r=s.data.data,o=this.generateTimeline(r);this.selectedTransaction={...r,timeline:o,customer_name:r.user_name||"N/A"}}else this.$swal.fire("Error!","Failed to load transaction details","error")}catch(s){console.error("Error loading transaction details:",s),this.selectedTransaction={...e,timeline:this.generateTimeline(e),customer_name:e.user_name||"N/A"}}},generateTimeline(e){const s=[];return s.push({title:"Transaction Initiated",description:`${e.type} transaction started`,timestamp:e.created_at,icon:"ri-play-circle-line"}),e.status==="COMPLETED"?s.push({title:"Transaction Completed",description:"Payment processed successfully",timestamp:e.updated_at,icon:"ri-check-line"}):e.status==="FAILED"?s.push({title:"Transaction Failed",description:e.error_message||"Payment processing failed",timestamp:e.updated_at,icon:"ri-close-circle-line"}):e.status==="PENDING"&&s.push({title:"Transaction Pending",description:"Payment is being processed",timestamp:e.updated_at,icon:"ri-time-line"}),s},downloadReceipt(e){try{const s={transaction_id:e.id,date:this.formatDate(e.created_at),amount:this.formatAmount(e.amount),status:e.status,type:e.type,customer:e.user_name||"N/A",reference:e.reference||"N/A"};m.post("/api/v1/transactions/receipt",s,{responseType:"blob"}).then(r=>{const o=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=o,i.setAttribute("download",`receipt-${e.id}.pdf`),document.body.appendChild(i),i.click(),i.remove(),this.$swal.fire("Success!","Receipt downloaded successfully","success")}).catch(r=>{console.error("Error downloading receipt:",r),this.$swal.fire("Error!","Failed to download receipt","error")})}catch(s){console.error("Error generating receipt:",s),this.$swal.fire("Error!","Failed to generate receipt","error")}},exportTransactions(){try{this.$swal.fire({title:"Exporting...",text:"Please wait while we generate your export file",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const e={format:"csv",status:this.filters.status,start_date:this.filters.startDate,end_date:this.filters.endDate,currency:this.currency};m.get("/api/v1/transactions/export",{params:e,responseType:"blob"}).then(s=>{const r=window.URL.createObjectURL(new Blob([s.data])),o=document.createElement("a");o.href=r;const i=s.headers["content-disposition"];let a="transactions-export.csv";if(i){const n=i.match(/filename="(.+)"/);n.length===2&&(a=n[1])}o.setAttribute("download",a),document.body.appendChild(o),o.click(),o.remove(),this.$swal.fire("Success!","Transactions exported successfully","success")}).catch(s=>{console.error("Error exporting transactions:",s),this.$swal.fire("Error!","Failed to export transactions","error")})}catch(e){console.error("Error initiating export:",e),this.$swal.fire("Error!","Failed to initiate export","error")}}},mounted(){this.loadTransactions()}},P={class:"transactions-container animate-fade-in"},D={class:"page-header"},x={class:"filters"},E={class:"date-range"},C={class:"stats-grid"},k={class:"stat-card"},I={class:"stat-info"},A={class:"amount"},F={class:"stat-card"},L={class:"stat-info"},N={class:"amount success"},S={class:"stat-card"},V={class:"stat-info"},R={class:"amount warning"},M={class:"stat-card"},U={class:"stat-info"},O={class:"amount danger"},B={class:"content-card"},G={class:"table-toolbar"},j={class:"search-box"},z={class:"table-container"},H={key:0},q={class:"actions"},J=["onClick"],K=["onClick"],Q={key:1},W={class:"pagination-container"},X={class:"pagination-info"},Y={class:"pagination"},Z=["disabled"],$=["onClick"],tt=["disabled"],st={key:0,class:"modal"},et={class:"modal-content"},it={class:"modal-header"},nt={class:"modal-body"},at={class:"detail-grid"},lt={class:"detail-item"},rt={class:"detail-item"},ot={class:"detail-item"},dt={class:"detail-item"},ct={class:"detail-item"},ut={class:"detail-item"},mt={class:"timeline"},pt={class:"timeline-icon"},gt={class:"timeline-content"},ht={class:"timeline-time"},ft={class:"modal-footer"};function vt(e,s,r,o,i,a){return c(),d("div",P,[t("div",D,[s[14]||(s[14]=t("h2",null,"Transactions History",-1)),t("div",x,[t("div",E,[g(t("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=n=>i.filters.startDate=n),class:"date-input"},null,512),[[f,i.filters.startDate]]),s[11]||(s[11]=t("span",null,"to",-1)),g(t("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=n=>i.filters.endDate=n),class:"date-input"},null,512),[[f,i.filters.endDate]])]),g(t("select",{"onUpdate:modelValue":s[2]||(s[2]=n=>i.filters.status=n),class:"status-filter"},s[12]||(s[12]=[t("option",{value:""},"All Status",-1),t("option",{value:"COMPLETED"},"Completed",-1),t("option",{value:"PENDING"},"Pending",-1),t("option",{value:"FAILED"},"Failed",-1)]),512),[[T,i.filters.status]]),t("button",{class:"btn-primary",onClick:s[3]||(s[3]=(...n)=>a.applyFilters&&a.applyFilters(...n))},s[13]||(s[13]=[t("i",{class:"ri-filter-3-line"},null,-1),u(" Apply Filters ")]))])]),t("div",C,[t("div",k,[t("div",I,[s[15]||(s[15]=t("h3",null,"Total Volume",-1)),t("p",A,l(a.formatAmount(i.stats.totalVolume)),1),s[16]||(s[16]=t("span",{class:"trend positive"},[t("i",{class:"ri-arrow-up-line"}),u(" 12.5% ")],-1))]),s[17]||(s[17]=t("div",{class:"stat-icon"},[t("i",{class:"ri-money-dollar-circle-line"})],-1))]),t("div",F,[t("div",L,[s[18]||(s[18]=t("h3",null,"Completed",-1)),t("p",N,l(i.stats.completed),1),s[19]||(s[19]=t("span",{class:"trend positive"},[t("i",{class:"ri-arrow-up-line"}),u(" 8.2% ")],-1))]),s[20]||(s[20]=t("div",{class:"stat-icon success-bg"},[t("i",{class:"ri-checkbox-circle-line"})],-1))]),t("div",S,[t("div",V,[s[21]||(s[21]=t("h3",null,"Pending",-1)),t("p",R,l(i.stats.pending),1),s[22]||(s[22]=t("span",{class:"trend neutral"},[t("i",{class:"ri-arrow-right-line"}),u(" 0% ")],-1))]),s[23]||(s[23]=t("div",{class:"stat-icon warning-bg"},[t("i",{class:"ri-time-line"})],-1))]),t("div",M,[t("div",U,[s[24]||(s[24]=t("h3",null,"Failed",-1)),t("p",O,l(i.stats.failed),1),s[25]||(s[25]=t("span",{class:"trend negative"},[t("i",{class:"ri-arrow-down-line"}),u(" 3.1% ")],-1))]),s[26]||(s[26]=t("div",{class:"stat-icon danger-bg"},[t("i",{class:"ri-close-circle-line"})],-1))])]),t("div",B,[t("div",G,[t("div",j,[s[27]||(s[27]=t("i",{class:"ri-search-line"},null,-1)),g(t("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>i.search=n),type:"text",placeholder:"Search transactions..."},null,512),[[f,i.search]])]),t("button",{class:"btn-secondary",onClick:s[5]||(s[5]=(...n)=>a.exportTransactions&&a.exportTransactions(...n))},s[28]||(s[28]=[t("i",{class:"ri-download-line"},null,-1),u(" Export ")]))]),t("div",z,[t("table",null,[s[32]||(s[32]=t("thead",null,[t("tr",null,[t("th",null,"Transaction ID"),t("th",null,"Date"),t("th",null,"Amount"),t("th",null,"Type"),t("th",null,"Status"),t("th",null,"Actions")])],-1)),i.loading?(c(),d("tbody",Q,s[31]||(s[31]=[t("tr",null,[t("td",{colspan:"6",class:"text-center"},[t("div",{class:"loading-spinner"},[t("i",{class:"ri-loader-4-line spin"}),u(" Loading... ")])])],-1)]))):(c(),d("tbody",H,[(c(!0),d(v,null,b(i.transactions,n=>(c(),d("tr",{key:n.id},[t("td",null,"#"+l(n.id),1),t("td",null,l(a.formatDate(n.created_at)),1),t("td",null,l(a.formatAmount(n.amount)),1),t("td",null,l(n.type),1),t("td",null,[t("span",{class:h(["status-badge",n.status.toLowerCase()])},l(n.status),3)]),t("td",q,[t("button",{class:"btn-icon mr-2",onClick:p=>a.viewDetails(n),title:"View Details"},s[29]||(s[29]=[t("i",{class:"ri-eye-line"},null,-1)]),8,J),t("button",{class:"btn-icon ml-2",onClick:p=>a.downloadReceipt(n),title:"Download Receipt"},s[30]||(s[30]=[t("i",{class:"ri-file-list-3-line"},null,-1)]),8,K)])]))),128))]))])]),t("div",W,[t("div",X," Showing "+l(a.startIndex)+" to "+l(a.endIndex)+" of "+l(i.totalItems)+" entries ",1),t("div",Y,[t("button",{disabled:i.currentPage===1,onClick:s[6]||(s[6]=n=>a.changePage(i.currentPage-1)),class:"pagination-btn"}," Previous ",8,Z),(c(!0),d(v,null,b(a.visiblePages,n=>(c(),d("button",{key:n,onClick:p=>a.changePage(n),class:h(["pagination-btn",{active:i.currentPage===n}])},l(n),11,$))),128)),t("button",{disabled:i.currentPage===a.totalPages,onClick:s[7]||(s[7]=n=>a.changePage(i.currentPage+1)),class:"pagination-btn"}," Next ",8,tt)])])]),i.selectedTransaction?(c(),d("div",st,[t("div",et,[t("div",it,[s[33]||(s[33]=t("h3",null,"Transaction Details",-1)),t("button",{class:"close-btn",onClick:s[8]||(s[8]=n=>i.selectedTransaction=null)},"Ã—")]),t("div",nt,[t("div",at,[t("div",lt,[s[34]||(s[34]=t("label",null,"Transaction ID",-1)),t("span",null,"#"+l(i.selectedTransaction.id),1)]),t("div",rt,[s[35]||(s[35]=t("label",null,"Date",-1)),t("span",null,l(a.formatDate(i.selectedTransaction.created_at)),1)]),t("div",ot,[s[36]||(s[36]=t("label",null,"Amount",-1)),t("span",null,l(a.formatAmount(i.selectedTransaction.amount)),1)]),t("div",dt,[s[37]||(s[37]=t("label",null,"Status",-1)),t("span",{class:h(["status-badge",i.selectedTransaction.status.toLowerCase()])},l(i.selectedTransaction.status),3)]),t("div",ct,[s[38]||(s[38]=t("label",null,"Type",-1)),t("span",null,l(i.selectedTransaction.type),1)]),t("div",ut,[s[39]||(s[39]=t("label",null,"Customer",-1)),t("span",null,l(i.selectedTransaction.customer_name),1)])]),t("div",mt,[(c(!0),d(v,null,b(i.selectedTransaction.timeline,(n,p)=>(c(),d("div",{class:"timeline-item",key:p},[t("div",pt,[t("i",{class:h(n.icon)},null,2)]),t("div",gt,[t("h4",null,l(n.title),1),t("p",null,l(n.description),1),t("span",ht,l(a.formatDate(n.timestamp)),1)])]))),128))])]),t("div",ft,[t("button",{class:"btn-secondary",onClick:s[9]||(s[9]=n=>i.selectedTransaction=null)},"Close"),t("button",{class:"btn-primary",onClick:s[10]||(s[10]=n=>a.downloadReceipt(i.selectedTransaction))},s[40]||(s[40]=[t("i",{class:"ri-download-line"},null,-1),u(" Download Receipt ")]))])])])):w("",!0)])}const wt=y(_,[["render",vt],["__scopeId","data-v-bb0ed47b"]]);export{wt as default};
